import numpy as np

from conv_layer import ConvLayer

dim_in = (2, 5, 5, 3)
layer = ConvLayer(dim_in, 3, 3, 1, 0, activation='relu')
X = np.ones((2, 5, 5, 3))
X[0, :, :, 0] = [[3, 3, 3, 5, 5],
                 [3, 3, 3, 5, 5],
                 [3, 3, 3, 5, 5],
                 [3, 3, 3, 5, 5],
                 [3, 3, 3, 5, 5]]
X[0, :, :, 1] = [[5, 5, 5, 3, 3],
                 [5, 5, 5, 3, 3],
                 [5, 5, 5, 3, 3],
                 [5, 5, 5, 3, 3],
                 [5, 5, 5, 3, 3]]
X[1, :, :, 0] = [[1, 1, 1, 1, 1],
                 [1, 1, 1, 1, 1],
                 [5, 5, 5, 5, 5],
                 [5, 5, 5, 5, 5],
                 [5, 5, 5, 5, 5]]
X[1, :, :, 1] = [[5, 5, 5, 5, 5],
                 [5, 5, 5, 5, 5],
                 [5, 5, 5, 5, 5],
                 [1, 1, 1, 1, 1],
                 [1, 1, 1, 1, 1]]

layer.W[:, :, 0, 0] = [[1, 0, -1], [1, 0, -1], [1, 0, -1]]
layer.W[:, :, 1, 0] = [[1, 1, 1], [0, 0, 0], [-1, -1, -1]]
layer.W[:, :, 2, 0] = [[1, 0, -1], [2, 0, -2], [1, 0, -1]]

Z = layer.forward(X)
